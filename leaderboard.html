<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–¢–æ–ø-5 –∏–≥—Ä–æ–∫–æ–≤</title>
    <link rel="stylesheet" href="static/CSS/Leaderboard.css">
</head>
<body>
    <div class="container">
        <h1>üèÜ TOP-5 Users</h1>
        <table class="leaderboard" id="leaderboard">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Player</th>
                    <th>Hits</th>
                </tr>
            </thead>
            <tbody>
                <tr><td colspan="3">Loading...</td></tr>
            </tbody>
        </table>
        <button class="back-btn" onclick="window.location.href='index.html'">Back</button>
    </div>

    <script>
        const BIN_URL = "https://api.jsonbin.io/v3/b/689b302443b1c97be91c6ed6";
        const MASTER_KEY = "$2a$10$IKI.MuTNot33ocK335Ynie2Rnj/x3BrG3RpcIdgGdq7dTDUCGWzai";

        fetch(BIN_URL, {
            headers: { "X-Master-Key": MASTER_KEY }
        })
        .then(res => {
            if (!res.ok) throw new Error(`Read error: ${res.status}`);
            return res.json();
        })
        .then(data => {
            let players = Array.isArray(data.record) ? data.record : [];

            players.sort((a, b) => b.hits - a.hits);

            const top5 = players.slice(0, 5);
            while (top5.length < 5) {
                top5.push({ username: "---", hits: 0 });
            }

            const tbody = document.querySelector("#leaderboard tbody");
            tbody.innerHTML = "";

            top5.forEach((player, index) => {
                const tr = document.createElement("tr");
                tr.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${player.username}</td>
                    <td>${player.hits}</td>
                `;
                tbody.appendChild(tr);
            });
        })
        .catch(err => {
            const tbody = document.querySelector("#leaderboard tbody");
            tbody.innerHTML = `<tr><td colspan="3">Loading error</td></tr>`;
            console.error(err);
        });
    </script>
</body>
</html>
